<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MCQ Infinity v6.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta name="theme-color" content="#2563eb">
  <link rel="manifest" href="manifest.json?v=6.0.0">
  <link rel="stylesheet" href="style.css?v=6.0.0">
  </head>
<body>

<div class="app-shell" id="appRoot">
  
  <nav class="nav-rail">
    <div class="nav-brand">
      <span class="logo-icon">üß¨</span>
      <span class="logo-text">Infinity</span>
    </div>
    
    <div class="nav-links">
      <button class="nav-item active" data-view="dashboard">
        <span class="icon">üìä</span> <span class="label">Dashboard</span>
      </button>
      <button class="nav-item" data-view="library">
        <span class="icon">üìö</span> <span class="label">Library</span>
      </button>
      <button class="nav-item" data-view="settings">
        <span class="icon">‚öôÔ∏è</span> <span class="label">Settings</span>
      </button>
    </div>

    <div class="nav-footer">
      <button id="btnNewSession" class="create-btn">
        <span class="icon">Ôºã</span> <span class="label">New Session</span>
      </button>
    </div>
  </nav>

  <main class="main-content">
    
    <header class="top-header">
      <div class="header-title" id="pageTitle">Dashboard</div>
      <div class="header-actions">
        <div class="sync-badge" id="syncStatus" title="Cloud Sync Status">‚òÅÔ∏è Offline</div>
        <button id="themeToggle" class="icon-btn" title="Toggle Theme">üåô</button>
      </div>
    </header>

    <div id="view-dashboard" class="view-section active">
      <div class="dashboard-grid">
        <div class="stat-card">
          <div class="stat-title">Total Questions</div>
          <div class="stat-value" id="statTotal">0</div>
          <div class="stat-sub">In Library</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Mastery Score</div>
          <div class="stat-value" id="statMastery">0%</div>
          <div class="stat-sub">Based on performance</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Due Review</div>
          <div class="stat-value highlight" id="statDue">0</div>
          <div class="stat-sub">Spaced Repetition</div>
        </div>

        <div class="chart-card">
          <h3>Weekly Activity</h3>
          <div class="chart-container" id="activityChart">
            </div>
        </div>

        <div class="chart-card">
          <h3>Weakest Areas</h3>
          <div class="weak-list" id="weakTopicsList">
            <div class="muted">Keep studying to generate data.</div>
          </div>
        </div>
      </div>
    </div>

    <div id="view-library" class="view-section">
      <div class="library-controls">
        <input type="text" id="libSearch" placeholder="Search question, tag, ID..." class="search-input">
        <select id="libFilter" class="filter-select">
          <option value="all">All Questions</option>
          <option value="flagged">Flagged üö©</option>
          <option value="notes">With Notes üìù</option>
          <option value="unseen">Unseen (New)</option>
        </select>
        <button id="btnOpenBuilder" class="secondary-btn">‚ú® AI Builder</button>
        <button id="btnImportExport" class="secondary-btn">üìÇ Data</button>
      </div>
      
      <div class="table-container">
        <table class="modern-table">
          <thead>
            <tr>
              <th width="40">#</th>
              <th>Question</th>
              <th width="100">Chapter</th>
              <th width="80">Stats</th>
              <th width="50">Edit</th>
            </tr>
          </thead>
          <tbody id="libraryBody">
            </tbody>
        </table>
        <div class="pagination-controls">
          <span id="libCount">0 questions</span>
          <div class="pager-btns">
            <button id="libPrev">‚Äπ</button>
            <span id="libPage">1</span>
            <button id="libNext">‚Ä∫</button>
          </div>
        </div>
      </div>
    </div>

    <div id="view-session" class="view-section">
      <div class="session-layout">
        <div class="q-pane">
          <div class="q-header">
            <span class="q-badge" id="qModeBadge">Practice</span>
            <span class="q-timer" id="qTimer">00:00</span>
            <div class="q-tools">
              <button class="tool-btn" id="btnFlagQ">üö© Flag</button>
              <button class="tool-btn" id="btnSearchQ">üîç Ref</button>
              <button class="tool-btn" id="btnExitSession">‚úï Exit</button>
            </div>
          </div>
          
          <div class="q-content" id="qText">Loading...</div>
          
          <div id="qImageArea" class="q-image hidden"></div>

          <div class="q-choices" id="qChoices"></div>

          <div class="q-notes">
            <label>My Notes:</label>
            <textarea id="qUserNote" placeholder="Add a clinical pearl..."></textarea>
          </div>
        </div>

        <div class="i-pane">
          <div class="action-bar">
            <button id="btnSubmit" class="hero-btn">Submit Answer</button>
            <button id="btnNext" class="hero-btn hidden">Next Question ‚Ä∫</button>
          </div>
          
          <div id="feedbackArea" class="feedback-box hidden">
            </div>
          
          <div id="srsControls" class="srs-bar hidden">
            <div class="srs-label">Rate difficulty:</div>
            <div class="srs-btns">
              <button class="srs-btn again" data-rate="1">Again <br><small>1m</small></button>
              <button class="srs-btn hard" data-rate="2">Hard <br><small>2d</small></button>
              <button class="srs-btn good" data-rate="3">Good <br><small>4d</small></button>
              <button class="srs-btn easy" data-rate="4">Easy <br><small>7d</small></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="view-settings" class="view-section">
      <div class="settings-grid">
        <div class="card">
          <h3>‚òÅÔ∏è Cloud Sync (GitHub)</h3>
          <div class="input-group">
            <label>Personal Access Token</label>
            <input type="password" id="ghToken" placeholder="ghp_...">
          </div>
          <div class="input-group">
            <label>Repository (User/Repo)</label>
            <input type="text" id="ghRepo" placeholder="username/repo">
          </div>
          <div class="input-group">
             <label>Filename</label>
             <input type="text" id="ghFile" value="mcq_backup.json">
          </div>
          <div class="btn-group">
            <button id="btnSaveGh" class="primary-btn">Save Config</button>
            <button id="btnUpload" class="action-btn">‚¨Ü Upload</button>
            <button id="btnDownload" class="action-btn">‚¨á Download</button>
          </div>
        </div>

        <div class="card">
          <h3>‚ö†Ô∏è Danger Zone</h3>
          <p class="muted">Manage your local data.</p>
          <div class="btn-group">
             <button id="btnWipeProgress" class="danger-btn">Reset Progress Only</button>
             <button id="btnFactoryReset" class="danger-btn">Factory Reset (Wipe All)</button>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>

<div id="modalWizard" class="modal hidden">
  <div class="modal-content wizard-box">
    <h2>Create New Session</h2>
    
    <div class="wizard-step">
      <label>1. Select Mode</label>
      <div class="mode-selector">
        <label class="mode-card active">
          <input type="radio" name="wizMode" value="tutor" checked>
          <strong>Tutor Mode</strong>
          <span>Untimed, see answers immediately.</span>
        </label>
        <label class="mode-card">
          <input type="radio" name="wizMode" value="exam">
          <strong>Exam Mode</strong>
          <span>Timed, see results at end.</span>
        </label>
      </div>
    </div>

    <div class="wizard-step">
      <label>2. Question Pool</label>
      <select id="wizPool">
        <option value="new">Unused Questions</option>
        <option value="due">Due for Review (SRS)</option>
        <option value="wrong">Incorrect History</option>
        <option value="all">All Questions</option>
      </select>
    </div>

    <div class="wizard-step">
      <label>3. Filter by Chapter (Optional)</label>
      <select id="wizChapter">
        <option value="">All Chapters</option>
        </select>
    </div>

    <div class="wizard-step">
      <label>4. Number of Questions</label>
      <input type="number" id="wizCount" value="10" min="1" max="100">
    </div>

    <div class="wizard-footer">
      <button class="secondary-btn" id="closeWizard">Cancel</button>
      <button class="primary-btn" id="startWizard">üöÄ Start Session</button>
    </div>
  </div>
</div>

<div id="modalBuilder" class="modal hidden">
  <div class="modal-content builder-box">
    <div class="modal-header">
      <h3>AI Question Builder</h3>
      <button class="close-icon" onclick="closeModal('modalBuilder')">‚úï</button>
    </div>
    <div class="builder-grid">
      <div class="b-col">
        <label>Source Text</label>
        <textarea id="aiSource" placeholder="Paste text here..."></textarea>
        <button id="aiGenPrompt" class="small-btn">Generate Prompt</button>
      </div>
      <div class="b-col">
        <label>Prompt (Copy to AI)</label>
        <textarea id="aiPrompt" readonly></textarea>
      </div>
      <div class="b-col full-width">
        <label>JSON Output (Paste here)</label>
        <textarea id="aiJson"></textarea>
        <button id="aiImport" class="primary-btn">Import Questions</button>
      </div>
    </div>
  </div>
</div>

<div id="modalData" class="modal hidden">
  <div class="modal-content">
    <h3>Data Management</h3>
    <div class="data-actions">
      <button id="btnExportFile" class="action-btn">Export JSON File</button>
      <div class="separator">OR</div>
      <input type="file" id="fileImport" accept=".json">
      <button id="btnImportFile" class="primary-btn">Import JSON File</button>
    </div>
    <button class="secondary-btn" onclick="closeModal('modalData')">Close</button>
  </div>
</div>

<div id="toastBox"></div>

<script src="app.js?v=6.0.0"></script>
</body>
</html>
