<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MCQ Ultra-Pro v5.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="manifest" href="manifest.json?v=5.0.0">
  <link rel="stylesheet" href="style.css?v=5.0.0">
</head>
<body>
<button id="btnExitFocus" class="floating-exit-focus">‚úï Exit Focus</button>
<button id="btnForceUpdate" class="floating-update-btn">‚Üª Update</button>

<div class="app" id="appRoot">
  <header class="top-bar">
    <div>
      <h1>MCQ Ultra‚ÄëPro <span class="ver">v5.0</span></h1>
      <div class="subtitle">Gold Edition: GitHub Sync + Builder + Focus + Notes</div>
    </div>
    <div class="chips">
      <span class="chip" id="cloudInfo">Checking Sync...</span>
      <select id="themeSelect" class="chip chip-theme">
        <option value="light">‚òÄÔ∏é Light</option>
        <option value="dark">üåô Dark</option>
      </select>
    </div>
  </header>

  <nav class="tabs">
    <button class="tab-button active" data-tab="home">Practice</button>
    <button class="tab-button" data-tab="flashcards">Flashcards</button>
    <button class="tab-button" data-tab="exam">Exam Sim</button>
    <button class="tab-button" data-tab="all">All Questions</button>
    <button class="tab-button" data-tab="backup">Backup & Cloud</button>
    <button class="tab-button" data-tab="settings">Settings</button>
  </nav>

  <main class="tab-container">
    <section class="tab-content active" id="tab-home">
      <div class="card">
        <div class="stats-row" id="statsBar">Loading...</div>
      </div>
      <div class="card">
        <div class="row">
          <div class="col-main">
            <div class="row-controls">
              <select id="modeSelect">
                <option value="due">Due (Spaced)</option>
                <option value="all">All Questions</option>
                <option value="new">New Only</option>
                <option value="wrong">Wrong</option>
                <option value="flagged">Flagged</option>
                <option value="chapter">By Chapter</option>
              </select>
              <select id="chapterSelect" style="display:none; max-width:200px;"></select>
              <button class="pill-btn" id="btnFocusMode">üßò Focus Mode</button>
            </div>
            <div id="questionPanel" class="question-panel"></div>
            <div id="searchTools" class="search-tools"></div>
            
            <div class="notes-area-container">
               <textarea id="userNoteArea" class="notes-textarea" placeholder="Study Notes..."></textarea>
               <div id="saveNoteStatus" class="save-note-status"></div>
            </div>
            <div id="feedbackPanel" class="feedback-panel"></div>
            <div class="btn-row-main">
               <button class="primary" id="btnSubmit">Submit</button>
               <button id="btnNext">Next</button>
               <label style="margin-left:10px; font-size:0.8em;"><input type="checkbox" id="guessCheck"> Guessing</label>
            </div>
            <div class="btn-row-tight">
               <button class="ghost" id="btnPrev">Prev</button>
               <button class="ghost" id="btnFlag">Flag</button>
            </div>
          </div>
          <div class="col-side">
             <div class="card side-card"><div id="relatedBox" class="tiny muted">Related Qs</div></div>
          </div>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-all">
      <div class="subnav">
        <button class="subnav-btn subnav-btn-active" data-allview="bank">Bank</button>
        <button class="subnav-btn" data-allview="builder">Builder</button>
      </div>
      
      <div id="allViewBank">
        <div class="card">
           <input id="allSearch" placeholder="Search...">
           <select id="allFilter">
             <option value="all">All</option>
             <option value="notes">Has Notes</option>
             <option value="flagged">Flagged</option>
             <option value="wrong">Wrong</option>
           </select>
           <button id="btnAllReload">Reload</button>
           <button id="btnAllDelete" class="danger">Delete Selected</button>
        </div>
        <div class="table-wrapper all-table-wrapper">
           <table class="q-table">
             <thead><tr><th>Sel</th><th>ID</th><th>Text</th><th>Ch</th><th>Stats</th><th>Edit</th></tr></thead>
             <tbody id="allTableBody"></tbody>
           </table>
        </div>
        <div class="all-footer">
           <span id="allSelectedCount">0</span>
           <button id="allPrevPage">&lt;</button>
           <span id="allPageInfo"></span>
           <button id="allNextPage">&gt;</button>
        </div>
      </div>

      <div id="allViewBuilder" style="display:none;">
        <div class="card">
          <h3>Builder</h3>
          <textarea id="builderSourceText" rows="4" placeholder="Paste Text"></textarea>
          <button id="btnBuilderMakePrompt">Generate Prompt</button>
          <textarea id="builderPromptOut" rows="4"></textarea>
          <textarea id="builderJsonInput" rows="4" placeholder="Paste JSON"></textarea>
          <button id="btnBuilderPreview">Preview</button>
          <button id="btnBuilderImportSelected" class="primary">Import</button>
          <div id="builderPreview"></div>
        </div>
      </div>
    </section>

    <section class="tab-content" id="tab-backup">
      <div class="card">
         <h2>GitHub Sync</h2>
         <div class="row-controls">
           <button id="btnCloudUpload">Upload ‚Üí GitHub</button>
           <button id="btnCloudDownload">Download ‚Üê GitHub</button>
         </div>
      </div>
      <div class="card">
         <h2>Local Backup</h2>
         <button id="btnBackupExport">Export File</button>
         <input type="file" id="backupFileInput">
         <button id="btnBackupImport">Import File</button>
      </div>
    </section>

    <section class="tab-content" id="tab-settings">
       <div class="card">
         <h2>GitHub Config</h2>
         <label>Token: <input type="password" id="ghTokenInput"></label><br>
         <label>Repo: <input id="ghRepoInput" value="Awad1992/mcq-data"></label><br>
         <label>File: <input id="ghFileInput" value="mcq_backup.json"></label><br><br>
         <button id="btnSaveGitHub" class="primary">Save Settings</button>
       </div>
       <div class="card">
         <h2>Danger Zone</h2>
         <button id="btnResetProgress" class="danger">Reset Progress</button>
       </div>
    </section>

    <section class="tab-content" id="tab-flashcards"><div class="card">Flashcards (Active in Full Code)</div></section>
    <section class="tab-content" id="tab-exam"><div class="card">Exam Sim (Active in Full Code)</div></section>
    <section class="tab-content" id="tab-dashboard"><div class="card">Dashboard (Active in Full Code)</div></section>

  </main>
</div>

<div id="editModal" class="modal hidden">
  <div class="modal-backdrop"></div>
  <div class="modal-body">
     <h3>Edit Question</h3>
     <textarea id="editText" rows="4"></textarea>
     <div class="modal-actions">
       <button id="btnEditSave" class="primary">Save</button>
       <button id="btnEditCancel">Cancel</button>
     </div>
  </div>
</div>

<script>window.APP_VERSION = "5.0.0";</script>
<script src="app.js?v=5.0.0"></script>
<script>
 if('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker.js?v=5.0.0').catch(()=>{});
</script>
</body>
</html>
