<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MCQ Titanium v16.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="theme-color" content="#2563eb">
  <link rel="manifest" href="manifest.json?v=16.0.0">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’</text></svg>">
</head>
<body>

<!-- Sound Effects (Preloaded) -->
<audio id="sfxCorrect" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="sfxWrong" src="https://actions.google.com/sounds/v1/cartoon/clank_car_crash.ogg"></audio>

<div id="toastContainer" class="toast-container"></div>

<div class="app" id="appRoot">
  
  <!-- Header -->
  <header class="top-bar">
    <div class="brand-area">
      <div class="logo">ğŸ’</div>
      <div class="user-stats">
        <h1>MCQ Titanium <span class="ver">v16.0</span></h1>
        <div class="xp-track">
           <div class="xp-bar"><div id="xpFill" style="width:0%"></div></div>
           <span class="xp-text"><span id="userRank">Intern</span> â€¢ <span id="userXP">0</span> XP</span>
        </div>
      </div>
    </div>
    <div class="chips">
      <div class="timer-chip" id="studyTimer" title="Session Time">00:00</div>
      <button id="btnSoundToggle" class="chip-icon" title="Toggle Sound">ğŸ”Š</button>
      <span class="chip" id="syncStatus">â˜ï¸ Offline</span>
      <button id="btnHeaderBackup" class="chip header-btn">ğŸ’¾ Sync</button>
      <button id="themeToggle" class="chip header-btn">ğŸŒ—</button>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs">
    <button class="tab-button active" data-tab="home">ğŸ§  Practice</button>
    <button class="tab-button" data-tab="all">ğŸ“š Library</button>
    <button class="tab-button" data-tab="flashcards">âš¡ Flashcards</button>
    <button class="tab-button" data-tab="exam">â±ï¸ Exam</button>
    <button class="tab-button" data-tab="dashboard">ğŸ“ˆ Stats</button>
    <button class="tab-button" data-tab="settings">âš™ï¸ Settings</button>
  </nav>

  <main class="tab-container">

    <!-- 1. PRACTICE TAB -->
    <section id="tab-home" class="tab-content active">
      <div class="card main-layout">
        <div class="row">
          <div class="col-main">
            <!-- Controls -->
            <div class="glass-panel controls-bar">
              <select id="modeSelect" class="std-select">
                <option value="due">ğŸ”¥ Smart Review (Due)</option>
                <option value="new">ğŸ†• New Questions</option>
                <option value="wrong">âŒ Mistakes</option>
                <option value="maintain">ğŸ”§ Maintenance</option>
                <option value="flagged">ğŸš© Flagged</option>
                <option value="chapter">ğŸ“‚ By Chapter</option>
                <option value="all">ğŸ”€ Random All</option>
              </select>
              
              <div id="chapterBox" class="hidden-anim">
                  <select id="chapterSelect" class="std-select chapter-list">
                      <option value="">All Chapters</option>
                  </select>
              </div>

              <button id="btnRefreshPractice" class="icon-btn refresh-btn" title="Apply Filters">â†»</button>
              
              <label class="check-label" title="Hide questions you've already mastered">
                 <input type="checkbox" id="prefSkipSolved" checked> Skip Mastered
              </label>
              
              <div class="spacer"></div>
              <button id="btnFocusMode" class="pill-btn focus-btn">ğŸ§˜ Zen Mode</button>
            </div>

            <!-- Maintenance Box -->
            <div id="maintBox" class="maint-box hidden">
               <div class="maint-header">ğŸ”§ Maintenance Report</div>
               <textarea id="maintNote" class="maint-input" placeholder="Describe the error in this question..."></textarea>
               <div style="text-align:right; margin-top:5px;">
                   <button id="btnSaveMaint" class="tiny-btn">Save Report</button>
               </div>
            </div>

            <!-- Question Area -->
            <div id="questionPanel" class="question-panel">
               <div class="loader">Loading Engine...</div>
            </div>

            <!-- Tools Strip -->
            <div class="tools-strip">
               <div id="searchTools" class="search-links"></div>
               <div class="tool-actions">
                   <button class="ghost-btn" id="btnFlag">Flag âš</button>
                   <button class="ghost-btn warning-text" id="btnMaintain">Report ğŸ”§</button>
               </div>
            </div>

            <!-- Notes -->
            <div class="notes-container">
              <div class="notes-header">
                 <label class="small-label">My Clinical Notes <span id="saveNoteStatus"></span></label>
                 <button id="btnSaveNoteManual" class="tiny-btn">ğŸ’¾ Save</button>
              </div>
              <textarea id="userNoteArea" class="notes-textarea" placeholder="Type key takeaways here (Auto-saved)..."></textarea>
            </div>

            <!-- Feedback -->
            <div id="feedbackPanel" class="feedback-panel hidden"></div>

            <!-- Main Actions -->
            <div class="action-footer">
                <div class="nav-group">
                    <button class="secondary-btn" id="btnPrev">â† Prev</button>
                </div>
                
                <div class="center-group">
                    <button class="primary-btn large pulse" id="btnSubmit">Submit Answer</button>
                    <button class="primary-btn large hidden" id="btnNext">Next Question â†’</button>
                </div>
                
                <div class="right-group">
                    <label class="check-label guess-box">
                        <input type="checkbox" id="guessCheck"> Guessing
                    </label>
                    <button id="btnExitFocus" class="danger-btn hidden">Exit Zen</button>
                </div>
            </div>

            <!-- SRS Grading (Appears after answer) -->
            <div id="srsButtons" class="srs-row hidden">
               <button class="srs-btn again" id="btnSrsAgain">Again (1m)</button>
               <button class="srs-btn hard" id="btnSrsHard">Hard (2d)</button>
               <button class="srs-btn good" id="btnSrsGood">Good (4d)</button>
               <button class="srs-btn easy" id="btnSrsEasy">Easy (7d)</button>
            </div>
            
          </div>
          
          <!-- Sidebar -->
          <div class="col-side">
             <div class="card side-card glass-panel">
                <div class="small-label">Session Stats</div>
                <div id="sessionStats" class="stats-text">0 Correct</div>
                <div class="stat-mini-bar"><div id="sessionBar" style="width:0%"></div></div>
             </div>
             <div class="card side-card glass-panel">
                <div class="small-label">History</div>
                <div class="history-list" id="historyList"></div>
             </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 2. LIBRARY TAB -->
    <section id="tab-all" class="tab-content">
      <div class="card library-card">
          <div class="library-sticky-header">
              <div class="filter-bar">
                 <input id="allSearch" placeholder="Search text, ID, tags..." class="std-input flex-grow">
                 <select id="allFilter" class="std-select">
                   <option value="all">All Status</option>
                   <option value="maintain">ğŸ”§ Maintenance</option>
                   <option value="notes">With Notes</option>
                   <option value="wrong">Errors</option>
                   <option value="flagged">Flagged</option>
                 </select>
                 <select id="allChapterSelect" class="std-select chapter-list"><option value="">All Chapters</option></select>
                 <button id="btnAllApply" class="refresh-btn">â†»</button>
              </div>

              <div class="action-bar">
                 <div class="action-group">
                    <button id="btnScanDup" class="pill-btn">ğŸ” Duplicates</button>
                    <span id="dupResult" class="muted small-label"></span>
                    <button id="btnFixDup" class="danger-btn small hidden">Fix</button>
                 </div>
                 <div class="spacer"></div>
                 <div class="action-group">
                    <button id="btnRangeMode" class="pill-btn">âœ¨ Range Select</button>
                    <button id="btnBulkDelete" class="danger-btn">Delete</button>
                    <input type="file" id="fileInput" accept=".json" class="hidden">
                    <button id="btnImportTrigger" class="secondary-btn">ğŸ“¥ Import</button>
                    <button id="btnExportTrigger" class="secondary-btn">ğŸ’¾ Export</button>
                 </div>
              </div>
              
              <div id="dropZone" class="drop-zone hidden">ğŸ“‚ Drop JSON Here</div>
          </div>

          <div class="table-wrapper">
            <table class="q-table">
              <thead>
                <tr>
                  <th width="40"><input type="checkbox" id="allSelectAll"></th>
                  <th class="sortable" data-key="id" width="70">ID â†•</th>
                  <th class="sortable" data-key="text" width="50%">Question â†•</th>
                  <th class="sortable" data-key="chapter" width="20%">Chapter â†•</th>
                  <th width="90">Tags</th>
                  <th width="50">Edit</th>
                </tr>
              </thead>
              <tbody id="allTableBody"></tbody>
            </table>
          </div>
          
          <div class="all-footer">
             <span id="selCount">0 Selected</span>
             <div class="pagination">
                <button id="allPrevPage" class="nav-btn">Prev</button>
                <span id="allPageInfo">1</span>
                <button id="allNextPage" class="nav-btn">Next</button>
             </div>
          </div>
      </div>
    </section>

    <!-- 3. FLASHCARDS TAB -->
    <section id="tab-flashcards" class="tab-content">
       <div class="card center-layout">
          <div class="fc-controls">
             <select id="fcSource" class="std-select"><option value="due">Due Cards</option><option value="weak">Weak Topics</option><option value="all">All Cards</option></select>
             <button id="btnFcShuffle" class="primary-btn">ğŸ”€ Shuffle</button>
          </div>
          <div id="fcCard" class="flashcard 3d-card">
             <div class="fc-face front" id="fcFront">Select Source & Shuffle</div>
             <div class="fc-face back" id="fcBack"></div>
          </div>
          <div class="fc-actions">
             <button id="btnFcShow" class="secondary-btn">Show Answer (Space)</button>
             <div id="fcGrading" class="hidden">
                <button id="btnFcAgain" class="danger-btn">Again</button>
                <button id="btnFcGood" class="primary-btn">Good</button>
             </div>
          </div>
       </div>
    </section>

    <!-- 4. EXAM TAB -->
    <section id="tab-exam" class="tab-content">
       <div class="card">
          <h2>Exam Simulator</h2>
          <div class="row-controls">
             <select id="examChapterSelect" class="std-select chapter-list"><option value="">All Chapters</option></select>
             <input id="examCount" type="number" value="40" class="std-input" style="width:70px" placeholder="Qty">
             <button id="btnStartExam" class="primary-btn">Start Exam</button>
          </div>
       </div>
       <div id="examInterface" class="card hidden">
           <div class="exam-header">
               <span>Question <span id="examProgress">1</span></span>
               <span id="examTimer" class="timer-badge">00:00</span>
           </div>
           <div id="examQPanel" class="question-panel"></div>
           <div class="btn-row-main">
              <button id="btnExamNext" class="nav-btn">Next</button>
              <button id="btnExamFinish" class="danger-btn">Finish</button>
           </div>
       </div>
       <div id="examResults" class="card hidden">
          <h3>Exam Results</h3>
          <h1 id="examScore" class="score-display">0%</h1>
          <button id="btnExamClose" class="pill-btn">Close</button>
       </div>
    </section>

    <!-- 5. DASHBOARD TAB -->
    <section id="tab-dashboard" class="tab-content">
       <div class="card">
          <h2>Performance Analytics</h2>
          <div class="dashboard-grid">
             <div class="dash-box"><h3>Total Questions</h3><span id="dashTotal" class="dash-val">0</span></div>
             <div class="dash-box"><h3>Maintenance</h3><span id="dashMaint" class="dash-val warning">0</span></div>
             <div class="dash-box"><h3>Mastery Level</h3><span id="dashMastery" class="dash-val">0%</span></div>
             <div class="dash-box"><h3>Learning Velocity</h3><span id="dashVelocity" class="dash-val success">+0/day</span></div>
          </div>
          
          <div class="chart-container glass-panel" style="margin-top:20px;">
             <canvas id="masteryChart" height="200"></canvas>
          </div>

          <div style="margin-top:20px; text-align:center;">
             <button id="btnRefreshStats" class="refresh-btn">â†» Refresh Data</button>
          </div>
       </div>
    </section>

    <!-- 6. SETTINGS TAB -->
    <section id="tab-settings" class="tab-content">
       <div class="card">
          <h3>â˜ï¸ GitHub Sync</h3>
          <div class="settings-grid">
             <input id="ghToken" placeholder="Personal Access Token" class="std-input">
             <input id="ghRepo" placeholder="Username/Repo" class="std-input">
             <input id="ghFile" value="mcq_backup.json" class="std-input">
          </div>
          <div class="btn-row-main">
             <button id="btnSaveGh" class="primary-btn">Save Configuration</button>
             <button id="btnCloudUpload" class="secondary-btn">Force Upload</button>
             <button id="btnCloudDownload" class="secondary-btn">Force Download</button>
          </div>
          <!-- Restore History -->
          <div style="margin-top:15px;">
              <label class="small-label">Restore Previous Version</label>
              <select id="backupHistory" class="std-select"><option>No backups found</option></select>
              <button id="btnRestoreBackup" class="tiny-btn">Restore</button>
          </div>
       </div>
       <div class="card" style="margin-top:20px; border-color:var(--danger);">
          <h3 style="color:var(--danger)">Danger Zone</h3>
          <button id="btnResetProgress" class="danger-btn">Reset Progress Only</button>
          <button id="btnFactoryReset" class="danger-btn">Factory Reset (Wipe All)</button>
       </div>
    </section>

  </main>
</div>

<!-- Edit Modal -->
<div id="editModal" class="modal hidden">
  <div class="modal-backdrop" id="editModalBackdrop"></div>
  <div class="modal-content">
     <h3>Edit Question</h3>
     <label class="small-label">Question Text</label>
     <textarea id="editText" class="std-textarea" rows="3"></textarea>
     <div class="row-inputs">
       <div style="flex:1"><label class="small-label">Chapter</label><input id="editChapter" class="std-input"></div>
       <div style="flex:1"><label class="small-label">Tags</label><input id="editTags" class="std-input"></div>
     </div>
     <label class="check-label warning-text"><input type="checkbox" id="editMaint"> ğŸ”§ Maintenance Required</label>
     <label class="small-label">Explanation</label>
     <textarea id="editExplanation" class="std-textarea" rows="3"></textarea>
     
     <div class="small-label">Choices</div>
     <div id="editChoicesList"></div>
     <button id="btnAddChoice" class="pill-btn small" style="margin-top:5px;">+ Add Choice</button>
     
     <div class="modal-footer">
        <button id="btnSaveEdit" class="primary-btn">Save Changes</button>
        <button id="btnCancelEdit" class="secondary-btn">Cancel</button>
     </div>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>


